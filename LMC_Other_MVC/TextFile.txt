//stored procedure:
CREATE PROCEDURE [dbo].[usp_GetInventoryRecordDetail]( @SerialNumber VARCHAR(12), @ScaleID VARCHAR(3))
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	--Get the count of records based on provided date
    SELECT inv.SerialNo AS SerialNumber,
			ISNULL(inv.PalletNo,'') AS PalletNumber,
			ISNULL(inv.ProductNo,'') AS ProductNumber,
			ISNULL(inv.LotNo,'') AS LotNumber,
			ISNULL(pal.SartoriLotNumber,'') AS SartoriLotNumber,
			ISNULL(pal.StockNumber,'') AS StockNumber,
			ISNULL(inv.MfgID,'') AS MfgNumber,
			ISNULL(pal.ProductDate,'') AS ProductDate,
			ISNULL(inv.PackDate,'') AS PackDate,
			ISNULL(pal.MakeDate,'') AS MakeDate,
			ISNULL(inv.CaseWeight,0.00) AS CaseWeight,
			ISNULL(pal.TareWeight,0.00) AS TareWeight,
			ISNULL(pal.AverageWeight,0.00) AS AverageWeight,
			ISNULL(pal.ShelfLife,'') AS ShelfLife,
			ISNULL(pal.TotalCaseCount,0) AS TotalCaseCount,
			ISNULL(pal.LabelSize,'') AS LabelSize,
			ISNULL(pal.Header,'') AS Header,
			ISNULL(pal.Description,'') AS Description,
			ISNULL(inv.CollectionTime,'') AS CollectionTime,
			ISNULL(pal.Collected,0) AS Collected,
			inv.ID,
			ISNULL(inv.Exported,0) AS Exported,
			ISNULL(inv.InsertDate,'') AS InsertDate
	FROM InventoryData inv
	INNER JOIN Pallet pal ON inv.SerialNo = pal.SerialNumber
	WHERE inv.SerialNo = @SerialNumber AND CONVERT(INT, LEFT(inv.SerialNo,3)) = @ScaleID

END
GO

//this is one of the 2 tables the stored procedure refers to:
CREATE TABLE [dbo].[InventoryData](
	[SerialNo] [varchar](12) NOT NULL,
	[ProductNo] [varchar](5) NULL,
	[BestBy] [date] NULL,
	[CaseWeight] [decimal](18, 2) NULL,
	[PackDate] [date] NULL,
	[ScaleName] [varchar](50) NULL,
	[ScaleID] [int] NULL,
	[PalletNo] [varchar](18) NULL,
	[LotNo] [varchar](11) NULL,
	[ID] [bigint] IDENTITY(1,1) NOT NULL,
	[MfgID] [varchar](7) NULL,
	[CollectionTime] [smalldatetime] NULL,
	[Exported] [bit] NULL,
	[ExportFailed] [bit] NULL,
	[FailureCount] [int] NULL,
	[LastFailure] [datetime] NULL,
	[InsertDate] [datetime] NULL,
 CONSTRAINT [PK_InventoryData] PRIMARY KEY CLUSTERED 
(
	[SerialNo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[InventoryData] ADD  CONSTRAINT [DF_InventoryData_ExportFailed]  DEFAULT ((0)) FOR [ExportFailed]
GO

ALTER TABLE [dbo].[InventoryData] ADD  CONSTRAINT [DF_InventoryData_FailureCount]  DEFAULT ((0)) FOR [FailureCount]
GO

ALTER TABLE [dbo].[InventoryData] ADD  CONSTRAINT [DF_InventoryData_InsertDate]  DEFAULT (getdate()) FOR [InsertDate]
GO

//this is the another table the stored procedure refers to:
REATE TABLE [dbo].[Pallet](
	[PalletNumber] [varchar](18) NOT NULL,
	[SerialNumber] [varchar](12) NOT NULL,
	[ProductNumber] [varchar](6) NOT NULL,
	[LotNumber] [varchar](11) NOT NULL,
	[SartoriLotNumber] [varchar](13) NULL,
	[StockNumber] [varchar](7) NULL,
	[MfgNumber] [varchar](7) NULL,
	[ProductDate] [date] NULL,
	[PackDate] [date] NULL,
	[MakeDate] [date] NULL,
	[CaseWeight] [numeric](18, 2) NULL,
	[TareWeight] [numeric](18, 2) NULL,
	[AverageWeight] [numeric](18, 2) NULL,
	[ShelfLife] [int] NULL,
	[TotalCaseCount] [int] NULL,
	[LabelSize] [varchar](6) NULL,
	[Header] [varchar](45) NULL,
	[Description] [varchar](22) NULL,
	[Collected] [bit] NULL,
	[ID] [bigint] IDENTITY(0,1) NOT NULL,
	[InsertDate] [datetime] NULL,
 CONSTRAINT [PK__Pallet__000000000000004F] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[Pallet] ADD  CONSTRAINT [DF_Pallet_InsertedDate]  DEFAULT (getdate()) FOR [InsertDate]
GO



//database model class:
namespace LMC_Other_InventoryData
{
    public class LMC_InvData_RecordDetail_Model
    {
        public  string? SerialNo { get; set; }
        public string? PalletNo { get; set; }
        public string? ProductNo { get; set; }
        public string? LotNo { get; set; }
        public string? SartoriLotNumber { get; set; }
        public string? StockNumber { get; set; }
        public string? MfgID { get; set; }
        public DateTime? ProductDate { get; set; }
        public DateTime? PackDate { get; set; }
        public DateTime? MakeDate { get; set; }
        public decimal? CaseWeight { get; set; }
        public decimal? TareWeight { get; set; }
        public decimal? AverageWeight { get; set; }
        public int? ShelfLife { get; set; }
        public int? TotalCaseCount { get; set; }
        public string? LabelSize { get; set; }
        public string? Header { get; set; }
        public string? Description { get; set; }
        public DateTime? CollectionTime { get; set; }
        public bool? Collected { get; set; }
        public long ID { get; set; }
        public bool? Exported { get; set; }
        public DateTime? InsertDate { get; set; }
    }
}


//view model class:



//class repository:


//controller:


//view:
